#+TITLE: Javascript Configuration
#+OPTIONS: toc:nil num:nil ^:nil

Configure modes for editing Javascript and JSON.

* Enable and autoload js2 mode for .js and .json files.
#+BEGIN_SRC emacs-lisp
  (require 'js2-mode)
  (autoload 'js2-mode "js2" nil t)
  (add-to-list 'auto-mode-alist '("\\.js$" . js2-mode))
  (add-to-list 'auto-mode-alist '("\\.json$" . js-mode))

  (add-hook 'js2-mode-hook (lambda ()
                             (setq indent-tabs-mode nil)
                             (setq tab-width 2)))
#+END_SRC

* Enable jsx-mode for .jsx files.
#+BEGIN_SRC emacs-lisp
  (require 'jsx-mode)
  (add-to-list 'auto-mode-alist '("\\.js[x]?\\'" . jsx-mode))
  (setq jsx-indent-level 2)
#+END_SRC

* Setup js-comint mode for a javascript repl.
#+BEGIN_SRC emacs-lisp
  (require 'js-comint)
  (setq inferior-js-program-command "/usr/bin/js")
  (add-hook 'js2-mode-hook
            '(lambda ()
               (local-set-key "\C-x\C-e" 'js-send-last-sexp)
               (local-set-key "\C-\M-x" 'js-send-last-sexp-and-go)
               (local-set-key "\C-cb" 'js-send-buffer)
               (local-set-key "\C-c\C-b" 'js-send-buffer-and-go)
               (local-set-key "\C-cl" 'js-load-file-and-go)))
#+END_SRC

* Fix node repl.
#+BEGIN_SRC emacs-lisp
  (setenv "NODE_NO_READLINE" "1")
#+END_SRC
